#### 0730-AI

##### 需求：

有一个Nginx 访问日志文件 `access.log`，格式如下（空格分隔，共10个字段，最后一个字段是响应时间，单位秒）

```bash
10.0.0.1 - - [30/Jul/2025:10:22:14 +0000] "GET /api/v1/users HTTP/1.1" 200 1234 "-" "curl/7.68.0" 0.045
10.0.0.2 - - [30/Jul/2025:10:22:15 +0000] "POST /api/v1/orders HTTP/1.1" 500 5678 "-" "python-requests/2.25.1" 1.234
```

请编写一个 Bash 脚本 `analyze_nginx_log.sh`，实现以下功能：

1. **参数校验**：脚本必须接受一个参数（日志文件路径），否则退出并提示用法。

2. **文件校验**：检查日志文件是否存在且可读，否则退出并报错。

3. **核心分析**：

   - 统计日志总行数。
   - 计算平均响应时间（保留3位小数）。
   - 找出响应时间最长的前5个请求（显示完整行）。
   - 统计HTTP状态码分布（如200、500各出现多少次）。

4. **输出格式**：结果以结构化方式输出，例如：

   ```bash
   ===== 分析结果 =====
   总请求数: 1000
   平均响应时间: 0.123s
   最长响应时间TOP5:
   1. [1.234s] 10.0.0.2 POST /api/v1/orders 500
   2. [0.987s] 10.0.0.3 GET /api/v1/products 200
   ...
   状态码分布:
   200: 850
   500: 120
   404: 30
   ```

```bash
#!/bin/bash

read -p "请输入nginx访问日志绝对路径:   " accesslog

#检查文件是否存在并且是否可读
if [ -f $accesslog && -r $accesslog ]
then
	echo "nginx访问日志文件存在并且可读"
	##统计总行数
	total=`awk 'END{print NR}' $accesslog`
	echo "===== 分析结果 ====="
	echo "总请求数：$total"
	
else
	echo "nginx访问日志文件不存在或者不可读"
	exit 1
fi



```

